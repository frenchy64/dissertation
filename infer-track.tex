\begin{figure*}
\begin{mathpar}

  \begin{array}{lllll}
    \trackmeta{}(\val{}, \path{}) = \val{}\ ;\ \res{}\\\\

    \trackmeta{}(\num{}, \path{})
    &=&
    n\ ; \{\path{} : \IntT{}\}
    \\
    \trackmeta{}([\lambda \xvar{}. \exp{}, \rho], \path{})
    &=&
    [
    \lambda \yvar{}.
      \trackE{((\lambda \xvar{}. \exp{}) \trackE{\yvar{}}{\appendone{\path{}}{\dompe{}}})}
             {\appendone{\path{}}{\rngpe{}}}
         , \rho]
         \ ; \{\path{} : [\UnknownT{} \rightarrow \UnknownT{}] \}
         \\
    &&
    \text{where}\ \yvar{} \text{ is fresh}
    \\
    \trackmeta{}(\{\overrightarrow{\val1\ \val2}\}, \path{})
    &=&
    \{\overrightarrow{\val1\ \val2{}'}\}
    \ ;\ \overrightarrow{\sqcup\ \res{}}
      \sqcup
    \{\path{} : \{\overrightarrow{\val1\ \UnknownT{}}\} \}
    \\
    &&
    \text{where}\ \overrightarrow{\trackmeta{}(\val2, \appendone{\path{}}{\keype{\overrightarrow{\val1}}{\val1}}) = \val2{}'\ ;\ \res{}}
    \\
    \\

         
%    \updatenoalign{\aenv{}}{\tenv{}}{\path{}}{\tau}{\atenv{}}
%    \\\\
%
%    \updatealign{\aenv{}}{\tenv{}}{\appendone{\path{}}{\keype{\overrightarrow{\kw{}'}}{\kw{}}}}{\ty{}}
%            {\update{\aenv{}}{\tenv{}}{\path{}}{\{\overrightarrow{\kw{}' : \UnknownT{}},\ \kw{} : \ty{} \}}}
%    \\
%    \updatealign{\aenv{}}{\tenv{}}{\appendone{\path{}}{\dompe{}}}{\ty{}}
%                {\update{\aenv{}}{\tenv{}}{\path{}}{\arrow{\ty{}}{\UnknownT{}}}}
%    \\
%    \updatealign{\aenv{}}{\tenv{}}{\appendone{\path{}}{\rngpe{}}}{\ty{}}
%                {\update{\aenv{}}{\tenv{}}{\path{}}{\arrow{\UnknownT{}}{\ty{}}}}
%    \\
%    \updatealign{\aenv{}}{\tenv{}}{[x]}{\ty{}}{(\tenv{}[\sigma / \xvar{}] , \aenv{}')}
%    \\
%    && \text{where}\ \tenv{}(\xvar{}) = \ty{}', join(\aenv{}, \ty{}, \ty{}') = \sigma\ ;\ \aenv{}'
%    \\
%    \updatealign{\aenv{}}{\tenv{}}{[\xvar{}]}{\ty{}}{(\tenv{}[\ty{} / \xvar{}], \aenv{})}
%    \\
%    && \text{where}\ \xvar{} \not\in dom(\tenv{})
%    \\
%
%    \\
%    \joinnoalign{\aenv{}}{\tau}{\tau}{\tau}
%    \\ \\
%
%    \joinalign{\aenv{}}{(\cup\ \overrightarrow{\tau_1})}{\tau}{(\cup\ \overrightarrow{\sigma})}\\
%                                                    && \text{where }
%                                                    \overrightarrow{\joinnoalign{\aenv{}}{\tau_1}{\tau}{\sigma}}
%    \\
%    \joinalign{\aenv{}}{\tau}{(\cup\ \overrightarrow{\tau_1})}{(\cup\ \overrightarrow{\sigma})} \\
%                                                    && \text{where }
%                                                    \overrightarrow{\joinnoalign{\aenv{}}{\tau_1}{\tau}{\sigma}}
%    \\
%    \joinalign{\aenv{}}{\UnknownT{}}{\tau}{\tau}
%    \\
%    \joinalign{\aenv{}}{\tau}{\UnknownT{}}{\tau}
%    \\
%    \joinalign{\aenv{}}{[\overrightarrow{\tau_1} \rightarrow \sigma_1]}{[\overrightarrow{\tau_2} \rightarrow \sigma_2]}{[\overrightarrow{\joinexpression{\aenv{}}{\tau_1}{\tau_2}}
%    \rightarrow
%    \joinexpression{\aenv{}}{\sigma_1}{\sigma_2}]}
%    \\
%    % TODO add condition on should-join-HMap?
%    %join(A, (HMap\  m_1\ o_1), (HMap\  m_2\ o_2))
%    %&=& joinHMap(A, (HMap\  m_1\ o_1), (HMap\  m_2\ o_2))
%    %\\
%    \joinalign{\aenv{}}{\tau}{\sigma}{(\cup\ \tau\ \sigma)}

  \end{array}

\end{mathpar}
  \label{infer:track}
  \caption{Value tracking}
\end{figure*}
